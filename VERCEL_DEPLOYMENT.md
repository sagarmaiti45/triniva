# Vercel Deployment Guide for Triniva AI

## Prerequisites
1. GitHub account
2. Vercel account (sign up at vercel.com)
3. All API keys ready

## Step 1: Prepare for GitHub

### 1.1 Update config.js for production
**IMPORTANT**: The config.js file is gitignored. For Vercel, we'll use environment variables instead.

### 1.2 Verify .gitignore
Make sure these files are in .gitignore:
- `.env`
- `.env.local`
- `/public/js/config.js` (contains API keys)

## Step 2: Push to GitHub

```bash
# Initialize git (if not already)
git init

# Add all files
git add .

# Commit
git commit -m "Initial commit - Triniva AI"

# Add GitHub remote
git remote add origin https://github.com/YOUR_USERNAME/triniva-ai.git

# Push to GitHub
git push -u origin main
```

## Step 3: Deploy to Vercel

### 3.1 Connect GitHub to Vercel
1. Go to [vercel.com](https://vercel.com)
2. Click "Add New Project"
3. Import your GitHub repository
4. Select the `triniva-ai` repository

### 3.2 Configure Build Settings
- **Framework Preset**: Other
- **Root Directory**: ./
- **Build Command**: `npm install`
- **Output Directory**: public
- **Install Command**: `npm install`

### 3.3 Add Environment Variables in Vercel

Click "Environment Variables" and add these:

| Name | Value | Description |
|------|-------|-------------|
| `OPENROUTER_API_KEY` | `sk-or-v1-...` | Your OpenRouter API key |
| `NEXT_PUBLIC_SUPABASE_URL` | `https://oofecaxnadoyqwxmyqtq.supabase.co` | Already set |
| `NEXT_PUBLIC_SUPABASE_ANON_KEY` | `eyJ...` | Your Supabase anon key |
| `SUPABASE_SERVICE_ROLE_KEY` | `eyJ...` | Your Supabase service role key |
| `DATABASE_URL` | `postgresql://...` | From Supabase Settings > Database |
| `JWT_SECRET` | `random-32-char-string` | Generate a random string |
| `NODE_ENV` | `production` | Environment |
| `NEXT_PUBLIC_SITE_URL` | `https://triniva.com` | Your domain |

### 3.4 Deploy
Click "Deploy" and wait for the build to complete.

## Step 4: Configure Custom Domain

### 4.1 In Vercel
1. Go to your project settings
2. Click "Domains"
3. Add `triniva.com` and `www.triniva.com`

### 4.2 DNS Configuration
Add these records to your domain DNS:

**For apex domain (triniva.com):**
```
Type: A
Name: @
Value: 76.76.21.21
```

**For www subdomain:**
```
Type: CNAME
Name: www
Value: cname.vercel-dns.com
```

### 4.3 SSL Certificate
Vercel automatically provisions SSL certificates. Wait 10-30 minutes for propagation.

## Step 5: Update Supabase for Production

### 5.1 Update Redirect URLs
In Supabase Dashboard > Authentication > URL Configuration:

**Site URL:**
```
https://triniva.com
```

**Redirect URLs:**
```
https://triniva.com/auth/callback.html
https://triniva.com
https://www.triniva.com/auth/callback.html
https://www.triniva.com
```

### 5.2 Update Google OAuth
In Google Cloud Console, add these redirect URIs:
```
https://oofecaxnadoyqwxmyqtq.supabase.co/auth/v1/callback
```

## Step 6: Create Environment Variables Script

Create a file to inject env vars into the frontend:

**Create `/public/js/env.js`:**
```javascript
// This file is generated by Vercel during build
window.ENV = {
    SUPABASE_URL: process.env.NEXT_PUBLIC_SUPABASE_URL,
    SUPABASE_ANON_KEY: process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,
    SITE_URL: process.env.NEXT_PUBLIC_SITE_URL
};
```

**Update HTML files to include:**
```html
<script src="/js/env.js"></script>
<script src="/js/config.js"></script>
```

## Step 7: Test Production Deployment

### 7.1 Test Authentication
1. Go to `https://triniva.com/auth/login.html`
2. Try OTP login
3. Try Google OAuth

### 7.2 Test API
1. Try chatting with AI models
2. Check token counting
3. Verify conversation persistence

### 7.3 Monitor Logs
- Check Vercel Functions logs
- Monitor Supabase logs
- Check browser console for errors

## Environment Variables Reference

### Required for Production:
```env
# API Keys
OPENROUTER_API_KEY=sk-or-v1-xxxxx
NEXT_PUBLIC_SUPABASE_URL=https://oofecaxnadoyqwxmyqtq.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJxxxxx
SUPABASE_SERVICE_ROLE_KEY=eyJxxxxx

# Database
DATABASE_URL=postgresql://postgres:[password]@db.oofecaxnadoyqwxmyqtq.supabase.co:5432/postgres

# Security
JWT_SECRET=generate-random-32-character-string-here

# Site
NEXT_PUBLIC_SITE_URL=https://triniva.com
NODE_ENV=production
PORT=3000
```

### Optional (Payment - add later):
```env
PAYU_MERCHANT_KEY=your_key
PAYU_MERCHANT_SALT=your_salt
PAYU_BASE_URL=https://secure.payu.in
```

## Troubleshooting

### Issue: "Module not found"
**Solution**: Make sure all dependencies are in package.json

### Issue: "Supabase connection failed"
**Solution**: Check environment variables are set correctly

### Issue: "OAuth redirect error"
**Solution**: Verify redirect URLs match exactly in Google Console and Supabase

### Issue: "CORS errors"
**Solution**: Add your domain to Supabase allowed origins

## Security Checklist

- [ ] Never commit `.env` files
- [ ] config.js is in .gitignore
- [ ] All sensitive keys are in environment variables
- [ ] HTTPS is enabled
- [ ] Supabase RLS is enabled
- [ ] Rate limiting is configured

## Post-Deployment

1. **Set up monitoring**: Use Vercel Analytics
2. **Configure alerts**: Set up error notifications
3. **Test payments**: Integrate PayU when ready
4. **SEO**: Add meta tags and sitemap
5. **Performance**: Enable caching and CDN

## Support

For deployment issues:
- Check Vercel docs: vercel.com/docs
- Check Supabase docs: supabase.com/docs
- Contact: support@triniva.com

---

**Important**: Keep this guide updated as you make changes to the deployment process.